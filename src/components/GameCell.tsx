import React, { forwardRef } from 'react';
import { useGameStore } from '../store/useGameStore';
import { FieldType, fieldDefinitions } from '@shared/fields';
import { useCellInteractionState } from '../utils/hooks/useCellInteractionState';
import './GameCell.css';
import clsx from 'clsx';

export const countryFlagIndexMap: Record<string, number> = {
  USSR: 0,
  USA_Ind: 1,
  USA_Int: 2,
  England: 3,
  Japan: 4,
  Balkan: 5,
  France: 6,
  BRD: 7,
  DDR: 8,
  Hungary: 9,
  Italy: 10,
  Holland: 11,
  Switzerland: 12,
};

export const industryIconIndexMap: Record<string, number> = {
  Avia: 0,
  Studio: 1,
  Oil: 2,
  Electro: 3,
  Newspaper: 4,
  Automotive: 5,
  Media: 6,
  Food: 7,
  Radio: 8,
  Tourism: 9,
  Healthcare: 10,
  Spy: 11,
  Port: 12,
};

export function getFielsIcon(type: FieldType): JSX.Element {
  switch (type) {
    case FieldType.Taxi :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_117)">
          <path d="M4 6H11V13H4V6Z" fill="#484848"/>
          <path d="M11 13H18V20H11V13Z" fill="#484848"/>
          <path d="M18 6H25V13H18V6Z" fill="#484848"/>
          <path d="M25 13H32V20H25V13Z" fill="#484848"/>
          <path d="M32 6H39V13H32V6Z" fill="#484848"/>
          </g>
          <defs>
          <filter id="filter0_di_47_117" x="4" y="6" width="35.5" height="14.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_117"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_117" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_117"/>
          </filter>
          </defs>
        </svg>
      );
    case FieldType.Birga :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_153)">
          <path d="M22 2C28.0751 2 33 6.92487 33 13C33 19.0751 28.0751 24 22 24C15.9249 24 11 19.0751 11 13C11 6.92487 15.9249 2 22 2ZM22 3C16.4772 3 12 7.47715 12 13C12 18.5228 16.4772 23 22 23C27.5228 23 32 18.5228 32 13C32 7.47715 27.5228 3 22 3Z" fill="#484848"/>
          </g>
          <circle cx="22" cy="13" r="10" fill="#EFEFEF"/>
          <path d="M28 16.5789C28 17.084 27.8698 17.5482 27.6094 17.9718C27.349 18.3872 26.9948 18.7456 26.5469 19.047C26.099 19.3484 25.5781 19.5846 24.9844 19.7556C24.401 19.9185 23.7865 20 23.1406 20H21.8594C21.2135 20 20.5938 19.9063 20 19.719C19.4167 19.5235 18.901 19.2588 18.4531 18.9248C18.0156 18.5909 17.6615 18.1999 17.3906 17.7519C17.1302 17.3039 17 16.8274 17 16.3224V15.8214L18.9219 15.5771V16.4079C18.9219 16.7093 19 16.9944 19.1563 17.2632C19.3229 17.5238 19.5417 17.7519 19.8125 17.9474C20.0833 18.1429 20.3958 18.2976 20.75 18.4117C21.1042 18.5257 21.474 18.5827 21.8594 18.5827H23.1406C23.526 18.5827 23.8958 18.5379 24.25 18.4483C24.6042 18.3587 24.9167 18.2325 25.1875 18.0695C25.4688 17.8985 25.6875 17.6949 25.8438 17.4586C26.0104 17.2224 26.0938 16.9536 26.0938 16.6523C26.0938 16.2043 25.9688 15.8377 25.7188 15.5526C25.4688 15.2675 25.1354 15.0313 24.7188 14.844C24.3125 14.6485 23.8438 14.4897 23.3125 14.3675C22.7917 14.2372 22.2552 14.1109 21.7031 13.9887C21.151 13.8584 20.6094 13.7118 20.0781 13.5489C19.5573 13.386 19.0885 13.1742 18.6719 12.9135C18.2656 12.6447 17.9375 12.3108 17.6875 11.9117C17.4375 11.5125 17.3125 11.0157 17.3125 10.4211C17.3125 9.91604 17.4375 9.45583 17.6875 9.04041C17.9375 8.61685 18.276 8.25439 18.7031 7.95301C19.1302 7.65163 19.625 7.41949 20.1875 7.25658C20.7604 7.08553 21.3698 7 22.0156 7H23.1406C23.7865 7 24.3958 7.09774 24.9688 7.29323C25.5417 7.48058 26.0417 7.74123 26.4688 8.07519C26.8958 8.40915 27.2292 8.80013 27.4688 9.24812C27.7188 9.69612 27.8438 10.1726 27.8438 10.6776V10.7265L25.9219 10.9709V10.5921C25.9219 10.2907 25.849 10.0097 25.7031 9.74906C25.5573 9.48026 25.3594 9.24812 25.1094 9.05263C24.8594 8.85714 24.5625 8.70238 24.2188 8.58835C23.8854 8.47431 23.526 8.41729 23.1406 8.41729H22.0156C21.6302 8.41729 21.2656 8.46209 20.9219 8.55169C20.5885 8.64129 20.2969 8.77162 20.0469 8.94267C19.7969 9.10558 19.599 9.30514 19.4531 9.54135C19.3073 9.77757 19.2344 10.0464 19.2344 10.3477C19.2344 10.7794 19.3594 11.1338 19.6094 11.4107C19.8594 11.6795 20.1875 11.9076 20.5938 12.0949C21.0104 12.2823 21.4792 12.4411 22 12.5714C22.5313 12.6936 23.0677 12.8239 23.6094 12.9624C24.1615 13.0927 24.6979 13.2434 25.2188 13.4145C25.75 13.5855 26.2188 13.8055 26.625 14.0742C27.0417 14.343 27.375 14.6811 27.625 15.0883C27.875 15.4875 28 15.9843 28 16.5789Z" fill="#484848"/>
          <path d="M21 6H22V21H21V6Z" fill="#484848"/>
          <path d="M23 6H24V21H23V6Z" fill="#484848"/>
          <defs>
          <filter id="filter0_di_47_153" x="11" y="2" width="22.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_153"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_153" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_153"/>
          </filter>
          </defs>
        </svg>
      );
    case FieldType.Jail :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_132)">
          <path d="M18 7.53516L18.5352 7L19.2422 7.70703L18.9492 8H25V1H27V7.53516L27.5352 7L28.2422 7.70703L27.9492 8H34V10H27V16.5352L27.5352 16L28.2422 16.707L27.9492 17H34V19H27V25H25V19.9492L24.707 20.2422L24 19.5352L24.5352 19H18V25H16V19.9492L15.707 20.2422L15 19.5352L15.5352 19H10V17H16V10.9492L15.707 11.2422L15 10.5352L15.5352 10H10V8H16V1H18V7.53516ZM18 16.5352L18.5352 16L19.2422 16.707L18.9492 17H25V10.9492L24.707 11.2422L24 10.5352L24.5352 10H18V16.5352Z" fill="#484848"/>
          </g>
          <defs>
          <filter id="filter0_di_47_132" x="10" y="1" width="24.5" height="24.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_132"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_132" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_132"/>
          </filter>
          </defs>
        </svg>
      );
    case FieldType.Start :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_87)">
            <path d="M4.52872 22.1265C3.8768 22.1265 3.33525 22.0675 2.90406 21.9494C2.478 21.8314 2.13407 21.6851 1.87228 21.5105C1.61562 21.3309 1.41799 21.1538 1.27939 20.9792C1.23319 20.9125 1.19213 20.8483 1.1562 20.7867C1.12026 20.7251 1.0946 20.6558 1.0792 20.5788C1.05867 20.4762 1.03813 20.3427 1.0176 20.1785C0.997067 20.0091 0.9945 19.814 1.0099 19.5933C1.01503 19.5009 1.033 19.4367 1.0638 19.4008C1.09973 19.3597 1.15876 19.3289 1.24089 19.3084C1.38976 19.2724 1.58225 19.2416 1.81838 19.216C2.05964 19.1852 2.23161 19.1698 2.33427 19.1698C2.44207 19.1698 2.52933 19.1903 2.59606 19.2314C2.6628 19.2724 2.74236 19.3417 2.83476 19.4393C2.93742 19.5471 3.11452 19.6857 3.36605 19.8551C3.61757 20.0193 4.00513 20.1015 4.52872 20.1015C5.03177 20.1015 5.41163 19.9962 5.66829 19.7858C5.92495 19.5753 6.05328 19.2827 6.05328 18.908C6.05328 18.7078 5.99169 18.5204 5.86849 18.3459C5.75042 18.1662 5.53226 17.9891 5.214 17.8146C4.89574 17.6349 4.44145 17.4476 3.85113 17.2525C2.87582 16.924 2.17257 16.5159 1.74138 16.0283C1.31019 15.5406 1.0946 14.863 1.0946 13.9955C1.0946 13.2768 1.26913 12.6763 1.61819 12.1937C1.96724 11.7112 2.44977 11.3468 3.06575 11.1004C3.68174 10.854 4.39269 10.7308 5.1986 10.7308C5.81972 10.7308 6.33304 10.8052 6.73857 10.9541C7.14923 11.0978 7.46748 11.2621 7.69335 11.4469C7.91921 11.6265 8.0655 11.7728 8.13224 11.8857C8.1733 11.9525 8.19897 12.0038 8.20923 12.0397C8.22463 12.0705 8.2349 12.1142 8.24003 12.1706C8.25543 12.3298 8.26057 12.5069 8.25543 12.7019C8.2503 12.897 8.23233 13.1177 8.20153 13.3641C8.18613 13.4462 8.1579 13.5027 8.11684 13.5335C8.0809 13.5592 8.02444 13.572 7.94744 13.572C7.44952 13.5823 7.06453 13.5566 6.79247 13.495C6.68467 13.4693 6.6128 13.4437 6.57687 13.418C6.54094 13.3923 6.49474 13.3513 6.43827 13.2948C6.35614 13.1973 6.22525 13.0844 6.04558 12.956C5.87105 12.8226 5.58873 12.7558 5.1986 12.7558C4.65962 12.7558 4.27719 12.879 4.05133 13.1254C3.82547 13.3667 3.71254 13.6387 3.71254 13.9416C3.71254 14.3009 3.87937 14.5833 4.21303 14.7886C4.54668 14.9888 5.07284 15.2172 5.79149 15.4739C6.39208 15.6843 6.90796 15.9128 7.33915 16.1591C7.77034 16.4055 8.09887 16.7212 8.32473 17.1062C8.55573 17.4912 8.67122 17.9994 8.67122 18.6308C8.67122 19.4162 8.48899 20.0681 8.12454 20.5865C7.76521 21.105 7.27242 21.4926 6.64617 21.7492C6.02505 22.0007 5.31923 22.1265 4.52872 22.1265Z" fill="#484848"/>
            <path d="M12.5159 21.1895C12.5159 21.4095 12.4827 21.5634 12.4165 21.6514C12.3554 21.732 12.2484 21.7723 12.0955 21.7723H10.4676C10.3148 21.7723 10.2052 21.732 10.139 21.6514C10.0779 21.5634 10.0473 21.4095 10.0473 21.1895V8.89524H7.7698C7.64752 8.89524 7.55581 8.86591 7.49467 8.80727C7.36219 8.67531 7.22463 8.51769 7.08197 8.33441C6.9444 8.15113 6.79409 7.9312 6.63105 7.67461C6.5801 7.5793 6.55463 7.50233 6.55463 7.44368C6.55463 7.3777 6.5801 7.30439 6.63105 7.22374C6.79409 6.96715 6.9444 6.74722 7.08197 6.56394C7.22463 6.38067 7.36219 6.22305 7.49467 6.09109C7.566 6.03244 7.65771 6.00311 7.7698 6.00311H14.801C14.9233 6.00311 15.015 6.03244 15.0761 6.09109C15.2086 6.22305 15.3462 6.38067 15.4888 6.56394C15.6315 6.74722 15.7818 6.96715 15.9397 7.22374C15.9907 7.31905 16.0162 7.39603 16.0162 7.45467C16.0162 7.52065 15.9907 7.59397 15.9397 7.67461C15.7818 7.9312 15.6315 8.15113 15.4888 8.33441C15.3462 8.51769 15.2086 8.67531 15.0761 8.80727C15.0048 8.86591 14.9131 8.89524 14.801 8.89524H12.5159V21.1895Z" fill="#484848"/>
            <path d="M21.0032 11.3391C21.2855 11.7343 21.573 12.2451 21.8656 12.8713C22.1633 13.4924 22.4508 14.1752 22.728 14.9195C23.0052 15.6638 23.2541 16.4261 23.4749 17.2063C23.7007 17.9814 23.8855 18.7283 24.0292 19.447C24.173 20.1656 24.2551 20.8047 24.2756 21.3642C24.2808 21.6363 24.1576 21.7723 23.906 21.7723H22.0427C21.8014 21.7723 21.6757 21.6517 21.6654 21.4104C21.6449 20.8355 21.5525 20.1374 21.3882 19.3161H17.1841C17.0404 20.1169 16.9582 20.815 16.9377 21.4104C16.9274 21.6517 16.7965 21.7723 16.545 21.7723H14.7202C14.6278 21.7723 14.5508 21.7467 14.4892 21.6953C14.4276 21.6389 14.3993 21.5439 14.4045 21.4104C14.4301 20.8406 14.5123 20.1939 14.6509 19.4701C14.7946 18.7412 14.9794 17.9866 15.2052 17.2063C15.4311 16.4261 15.6826 15.6638 15.9598 14.9195C16.237 14.17 16.5245 13.4847 16.8222 12.8636C17.1199 12.2425 17.41 11.7343 17.6923 11.3391C17.8411 11.1286 17.9977 10.9746 18.162 10.8771C18.3314 10.7795 18.5393 10.7308 18.7857 10.7308H19.8944C20.146 10.7308 20.3564 10.7795 20.5258 10.8771C20.6952 10.9746 20.8543 11.1286 21.0032 11.3391ZM19.263 13.1639C18.9243 13.7029 18.6137 14.3471 18.3314 15.0966C18.049 15.846 17.8052 16.616 17.5999 17.4065H20.9416C20.726 16.616 20.4771 15.846 20.1947 15.0966C19.9124 14.3471 19.6172 13.7029 19.3092 13.1639H19.263Z" fill="#484848"/>
            <path d="M27.9294 21.3642C27.9294 21.5182 27.896 21.626 27.8293 21.6876C27.7677 21.7441 27.6599 21.7723 27.5059 21.7723H25.8658C25.7118 21.7723 25.6015 21.7441 25.5347 21.6876C25.4731 21.626 25.4423 21.5182 25.4423 21.3642V12.7943C25.4423 12.281 25.4885 11.8755 25.5809 11.5778C25.6784 11.2749 25.8632 11.0593 26.1353 10.931C26.4125 10.7975 26.8155 10.7308 27.3442 10.7308H29.3846C32.0642 10.7308 33.4039 11.76 33.4039 13.8184C33.4039 14.4447 33.2987 14.958 33.0882 15.3584C32.8778 15.7588 32.616 16.0719 32.3029 16.2977C31.9897 16.5185 31.6817 16.6853 31.3789 16.7982V16.8367C31.7228 17.0626 32.0488 17.3603 32.3568 17.7299C32.6699 18.0944 32.9522 18.4922 33.2037 18.9234C33.4553 19.3494 33.6683 19.7729 33.8428 20.1939C34.0174 20.6096 34.138 20.9818 34.2047 21.3103C34.2355 21.4643 34.2355 21.5798 34.2047 21.6568C34.1791 21.7338 34.0918 21.7723 33.9429 21.7723H32.1643C32.0308 21.7723 31.9127 21.7441 31.8101 21.6876C31.7125 21.6312 31.6227 21.5003 31.5406 21.2949C31.1505 20.3145 30.7013 19.5163 30.1931 18.9003C29.6849 18.2792 29.1947 17.7812 28.7224 17.4065C28.4196 17.1653 28.2682 16.9933 28.2682 16.8906C28.2682 16.8085 28.3169 16.6956 28.4145 16.5518C28.4761 16.4646 28.5659 16.3593 28.6839 16.2361C28.802 16.113 28.9047 16.0206 28.9919 15.959C29.0792 15.8974 29.1485 15.8589 29.1998 15.8435C29.2563 15.8281 29.341 15.8204 29.4539 15.8204C29.8338 15.8204 30.1495 15.6895 30.401 15.4277C30.6577 15.1659 30.786 14.7526 30.786 14.188C30.786 13.6541 30.65 13.264 30.3779 13.0176C30.111 12.7661 29.7414 12.6403 29.2691 12.6403H28.8071C28.4684 12.6403 28.2374 12.7122 28.1142 12.8559C27.991 12.9997 27.9294 13.246 27.9294 13.5951V21.3642Z" fill="#484848"/>
            <path d="M38.4997 21.1864C38.4997 21.4063 38.4666 21.5603 38.4003 21.6483C38.3392 21.7289 38.2322 21.7692 38.0793 21.7692H36.4515C36.2986 21.7692 36.1891 21.7289 36.1228 21.6483C36.0617 21.5603 36.0311 21.4063 36.0311 21.1864V8.89213H33.7536C33.6313 8.89213 33.5396 8.8628 33.4785 8.80415C33.346 8.67219 33.2085 8.51457 33.0658 8.3313C32.9282 8.14802 32.7779 7.92808 32.6149 7.6715C32.5639 7.57619 32.5385 7.49921 32.5385 7.44056C32.5385 7.37458 32.5639 7.30127 32.6149 7.22063C32.7779 6.96404 32.9282 6.74411 33.0658 6.56083C33.2085 6.37755 33.346 6.21993 33.4785 6.08797C33.5498 6.02932 33.6415 6 33.7536 6H40.7848C40.9071 6 40.9988 6.02932 41.06 6.08797C41.1924 6.21993 41.33 6.37755 41.4727 6.56083C41.6153 6.74411 41.7656 6.96404 41.9236 7.22063C41.9745 7.31594 42 7.39291 42 7.45156C42 7.51754 41.9745 7.59085 41.9236 7.6715C41.7656 7.92808 41.6153 8.14802 41.4727 8.3313C41.33 8.51457 41.1924 8.67219 41.06 8.80415C40.9886 8.8628 40.8969 8.89213 40.7848 8.89213H38.4997V21.1864Z" fill="#484848"/>
            <path d="M1.67582 6H5.05495L5.73077 7.57692L5.05495 8.91731H1.67582L1 7.57692L1.67582 6Z" fill="#484848"/>
            <path d="M17.5577 6H30.9616L31.7501 7.57692L30.9616 8.91731H17.5577L16.7693 7.57692L17.5577 6Z" fill="#484848"/>
          </g>
          <defs>
            <filter id="filter0_di_47_87" x="1" y="6" width="41.5" height="16.6265" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="0.5" dy="0.5"/>
              <feComposite in2="hardAlpha" operator="out"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_87"/>
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_87" result="shape"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="0.5" dy="0.5"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
              <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_87"/>
            </filter>
          </defs>
        </svg>
      );
    case FieldType.Pip :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_48_179)">
          <path d="M22 2C22.28 2 22.5573 2.01361 22.832 2.03418C22.9342 2.04182 23.0363 2.0472 23.1377 2.05762C23.139 2.05775 23.1403 2.05846 23.1416 2.05859L23.6748 2.12695C23.6787 2.12755 23.6826 2.1283 23.6865 2.12891C23.7579 2.1399 23.8285 2.15463 23.8994 2.16699C24.0121 2.18662 24.1248 2.20451 24.2363 2.22754C24.3229 2.24543 24.4084 2.2672 24.4941 2.28711C24.5835 2.30784 24.6732 2.32672 24.7617 2.34961C24.8273 2.36659 24.8919 2.38711 24.957 2.40527C25.2523 2.48752 25.5434 2.57887 25.8281 2.68457C25.8485 2.69215 25.8683 2.70129 25.8887 2.70898C26.0367 2.76494 26.1832 2.82366 26.3281 2.88574C26.3599 2.89936 26.3912 2.91383 26.4229 2.92773C26.5389 2.97877 26.6546 3.03007 26.7686 3.08496L26.833 3.11719C26.8626 3.13168 26.8915 3.14736 26.9209 3.16211C27.0479 3.22575 27.1737 3.29103 27.2979 3.35938C27.3235 3.37353 27.3485 3.38897 27.374 3.40332C27.6616 3.56472 27.942 3.73709 28.2129 3.92285C28.241 3.94212 28.268 3.9629 28.2959 3.98242C28.415 4.06572 28.5329 4.15045 28.6484 4.23828C28.6695 4.25428 28.69 4.27096 28.7109 4.28711C28.8339 4.38194 28.9555 4.47828 29.0742 4.57812C29.0799 4.58287 29.0852 4.58801 29.0908 4.59277C31.4808 6.61057 33 9.62726 33 13C33 16.7286 31.1423 20.0204 28.3047 22.0098C28.2682 22.0353 28.2331 22.0628 28.1963 22.0879C28.1081 22.1481 28.0177 22.205 27.9277 22.2627C27.8714 22.2988 27.8158 22.336 27.7588 22.3711C27.6838 22.4173 27.6075 22.4614 27.5312 22.5059C27.4557 22.5499 27.3804 22.5944 27.3037 22.6367C27.2337 22.6753 27.1627 22.7119 27.0918 22.749C27.0108 22.7914 26.9298 22.8336 26.8477 22.874C26.7769 22.9088 26.7054 22.9423 26.6338 22.9756C26.5497 23.0147 26.4651 23.0528 26.3799 23.0898C26.2906 23.1287 26.2009 23.1666 26.1104 23.2031C26.0543 23.2258 25.9979 23.2478 25.9414 23.2695C25.8369 23.3097 25.732 23.3487 25.626 23.3857C25.5661 23.4067 25.5057 23.4264 25.4453 23.4463C25.3443 23.4796 25.2429 23.5116 25.1406 23.542C25.0674 23.5638 24.9938 23.5842 24.9199 23.6045C24.8324 23.6285 24.7446 23.6519 24.6562 23.6738C24.5685 23.6956 24.4802 23.7157 24.3916 23.7354C24.3082 23.7539 24.2247 23.7725 24.1406 23.7891C24.0396 23.809 23.938 23.8266 23.8359 23.8438C23.7677 23.8552 23.6995 23.8677 23.6309 23.8779C23.5262 23.8935 23.421 23.9063 23.3154 23.9189C23.2362 23.9284 23.1569 23.9385 23.0771 23.9463C22.9702 23.9567 22.8627 23.9634 22.7549 23.9707C22.6863 23.9754 22.6177 23.982 22.5488 23.9854C22.367 23.9943 22.1841 24 22 24C21.815 24 21.631 23.9944 21.4482 23.9854C21.3901 23.9825 21.3323 23.9764 21.2744 23.9727C21.1541 23.9648 21.0342 23.958 20.915 23.9463C20.8316 23.9381 20.7489 23.926 20.666 23.916C20.5696 23.9044 20.4735 23.893 20.3779 23.8789C20.3093 23.8688 20.2411 23.8571 20.1729 23.8457C20.061 23.827 19.9495 23.8082 19.8389 23.7861C19.7695 23.7723 19.7007 23.7563 19.6318 23.7412C19.5311 23.7191 19.4307 23.6967 19.3311 23.6719C19.2558 23.6531 19.1811 23.6326 19.1064 23.6123C19.0162 23.5877 18.9262 23.5629 18.8369 23.5361C18.7436 23.5081 18.6509 23.4786 18.5586 23.4482C18.4929 23.4266 18.4274 23.4047 18.3623 23.3818C18.269 23.3491 18.1762 23.3154 18.084 23.2803C18.0063 23.2507 17.9293 23.2198 17.8525 23.1885C17.7719 23.1556 17.692 23.1216 17.6123 23.0869C17.5301 23.0511 17.4484 23.0143 17.3672 22.9766C17.2965 22.9437 17.2261 22.9103 17.1562 22.876C17.0619 22.8296 16.9687 22.7814 16.876 22.7324C16.8186 22.7022 16.7609 22.6728 16.7041 22.6416C16.6148 22.5925 16.5272 22.5408 16.4395 22.4893C16.3728 22.4501 16.306 22.4116 16.2402 22.3711C16.1724 22.3293 16.1059 22.2854 16.0391 22.2422C15.9614 22.192 15.883 22.1429 15.8066 22.0908C15.7413 22.0462 15.6776 21.9991 15.6133 21.9531C15.5391 21.9001 15.4644 21.8478 15.3916 21.793C15.3282 21.7452 15.2664 21.6955 15.2041 21.6465C12.6451 19.6324 11 16.5092 11 13C11 10.0136 12.1913 7.30632 14.123 5.32422C14.1271 5.3201 14.1307 5.31564 14.1348 5.31152C14.368 5.07298 14.6123 4.84553 14.8662 4.62891C14.8852 4.61273 14.9038 4.59613 14.9229 4.58008C15.0281 4.49155 15.1356 4.40589 15.2441 4.32129C15.2809 4.29262 15.3174 4.26356 15.3545 4.23535C15.4784 4.14124 15.6045 4.04984 15.7324 3.96094C15.7445 3.95254 15.7564 3.9439 15.7686 3.93555C15.7957 3.91685 15.8223 3.89736 15.8496 3.87891L16.2129 3.64453C16.2217 3.63906 16.2304 3.63338 16.2393 3.62793C16.3399 3.56592 16.4431 3.50804 16.5459 3.44922C16.6017 3.41727 16.6565 3.38353 16.7129 3.35254C16.8228 3.29217 16.9347 3.23539 17.0469 3.17871C17.09 3.15691 17.1323 3.13355 17.1758 3.1123C17.3022 3.05053 17.4305 2.99256 17.5596 2.93555C17.5955 2.91965 17.6308 2.90224 17.667 2.88672C17.7977 2.83066 17.9302 2.77863 18.0635 2.72754C18.0997 2.71362 18.1354 2.69811 18.1719 2.68457C18.4774 2.57116 18.7898 2.47308 19.1074 2.38672C19.1453 2.37642 19.1827 2.3644 19.2207 2.35449C19.3486 2.32121 19.4778 2.29243 19.6074 2.26367C19.6576 2.25252 19.7074 2.23897 19.7578 2.22852C19.8532 2.20876 19.9496 2.19305 20.0459 2.17578C20.1368 2.15946 20.2276 2.14103 20.3193 2.12695C20.3867 2.11663 20.4547 2.11066 20.5225 2.10156C20.636 2.0863 20.7496 2.06938 20.8643 2.05762C20.9479 2.04904 21.032 2.04478 21.1162 2.03809C21.4078 2.01487 21.7024 2 22 2ZM21.9902 13.5L14.8164 6.04492C13.0735 7.84474 12 10.2967 12 13C12 15.9523 13.2799 18.605 15.3145 20.4355L21.9902 13.5L28.6729 20.4453C30.7143 18.6145 32 15.958 32 13C32 10.291 30.9213 7.83503 29.1719 6.03418L21.9902 13.5Z" fill="#484848"/>
          </g>
          <defs>
          <filter id="filter0_di_48_179" x="11" y="2" width="22.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_48_179"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_48_179" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_48_179"/>
          </filter>
          </defs>
        </svg>
      );
    case FieldType.Ques :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_91)">
            <path d="M19.8329 16.1292C19.5815 16.1292 19.4026 16.0364 19.2962 15.8508C19.1511 15.5869 19.0786 15.0935 19.0786 14.3704C19.0786 13.5203 19.2333 12.8363 19.5428 12.3185C19.862 11.7908 20.4035 11.2729 21.1675 10.7648C21.6898 10.4131 22.1153 10.115 22.4441 9.87075C22.7826 9.62647 23.0292 9.36265 23.1839 9.07928C23.3386 8.78614 23.416 8.40995 23.416 7.9507C23.416 7.27648 23.2032 6.75861 22.7777 6.39707C22.3619 6.02576 21.772 5.84011 21.008 5.84011C20.3697 5.84011 19.7701 5.9427 19.2092 6.1479C18.6579 6.34333 18.2034 6.54852 17.8456 6.76349C17.7199 6.84166 17.5893 6.8612 17.4539 6.82212C17.3185 6.78303 17.2218 6.69021 17.1638 6.54364L16.0468 3.89074C15.9501 3.666 16.0033 3.49012 16.2064 3.36309C16.6609 3.07972 17.3234 2.7817 18.1937 2.46902C19.0738 2.15634 20.2198 2 21.6317 2C22.8309 2 23.9092 2.18077 24.8666 2.54231C25.8337 2.90384 26.5977 3.47546 27.1586 4.25716C27.7195 5.03886 28 6.05507 28 7.3058C28 8.21452 27.8888 8.96691 27.6664 9.56296C27.4439 10.159 27.1006 10.6915 26.6364 11.1606C26.1819 11.6198 25.6016 12.1035 24.8956 12.6116C24.0543 13.2174 23.503 13.6718 23.2419 13.9747C22.9808 14.2776 22.8503 14.5707 22.8503 14.8541C22.8503 15.0593 22.8696 15.2205 22.9083 15.3378C22.947 15.4453 22.9663 15.5674 22.9663 15.7042C22.9663 15.9876 22.7971 16.1292 22.4586 16.1292H19.8329ZM18.1792 20.8341C18.1792 20.7071 18.2179 20.5947 18.2953 20.497C18.3823 20.3895 18.4935 20.2527 18.6289 20.0866C18.919 19.7544 19.2527 19.4075 19.6299 19.046C20.007 18.6747 20.3939 18.318 20.7904 17.976C21.0321 17.7806 21.211 17.6829 21.3271 17.6829C21.4431 17.6829 21.6317 17.7806 21.8928 17.976C22.7052 18.6893 23.416 19.3928 24.0253 20.0866C24.151 20.2527 24.2574 20.3895 24.3444 20.497C24.4314 20.5947 24.475 20.7071 24.475 20.8341C24.475 20.9709 24.4266 21.093 24.3299 21.2005C24.2429 21.308 24.1365 21.4497 24.0108 21.6256C23.7303 21.948 23.4015 22.29 23.0243 22.6516C22.6568 23.0033 22.2797 23.3502 21.8928 23.6922C21.6511 23.8974 21.4625 24 21.3271 24C21.2207 24 21.0321 23.8974 20.7613 23.6922C20.3455 23.3502 19.9587 22.9984 19.6008 22.6369C19.243 22.2754 18.919 21.9236 18.6289 21.5816C18.4935 21.4155 18.3823 21.2836 18.2953 21.1859C18.2179 21.0882 18.1792 20.9709 18.1792 20.8341Z" fill="#484848"/>
          </g>
          <defs>
            <filter id="filter0_di_47_91" x="16" y="2" width="12.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="0.5" dy="0.5"/>
              <feComposite in2="hardAlpha" operator="out"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_91"/>
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_91" result="shape"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="0.5" dy="0.5"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
              <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_91"/>
            </filter>
          </defs>
        </svg>
      );
    case FieldType.Ques3 :
      return (
        <svg
          className="w-full h-full"
          viewBox="0 0 43 27"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_di_47_99)">
          <path d="M19.8329 16.1292C19.5815 16.1292 19.4026 16.0364 19.2962 15.8508C19.1511 15.5869 19.0786 15.0935 19.0786 14.3704C19.0786 13.5203 19.2333 12.8363 19.5428 12.3185C19.862 11.7908 20.4035 11.2729 21.1675 10.7648C21.6898 10.4131 22.1153 10.115 22.4441 9.87075C22.7826 9.62647 23.0292 9.36265 23.1839 9.07928C23.3386 8.78614 23.416 8.40995 23.416 7.9507C23.416 7.27648 23.2032 6.75861 22.7777 6.39707C22.3619 6.02576 21.772 5.84011 21.008 5.84011C20.3697 5.84011 19.7701 5.9427 19.2092 6.1479C18.6579 6.34333 18.2034 6.54852 17.8456 6.76349C17.7199 6.84166 17.5893 6.8612 17.4539 6.82212C17.3185 6.78303 17.2218 6.69021 17.1638 6.54364L16.0468 3.89074C15.9501 3.666 16.0033 3.49012 16.2064 3.36309C16.6609 3.07972 17.3234 2.7817 18.1937 2.46902C19.0738 2.15634 20.2198 2 21.6317 2C22.8309 2 23.9092 2.18077 24.8666 2.54231C25.8337 2.90384 26.5977 3.47546 27.1586 4.25716C27.7195 5.03886 28 6.05507 28 7.3058C28 8.21452 27.8888 8.96691 27.6664 9.56296C27.4439 10.159 27.1006 10.6915 26.6364 11.1606C26.1819 11.6198 25.6016 12.1035 24.8956 12.6116C24.0543 13.2174 23.503 13.6718 23.2419 13.9747C22.9808 14.2776 22.8503 14.5707 22.8503 14.8541C22.8503 15.0593 22.8696 15.2205 22.9083 15.3378C22.947 15.4453 22.9663 15.5674 22.9663 15.7042C22.9663 15.9876 22.7971 16.1292 22.4586 16.1292H19.8329ZM18.1792 20.8341C18.1792 20.7071 18.2179 20.5947 18.2953 20.497C18.3823 20.3895 18.4935 20.2527 18.6289 20.0866C18.919 19.7544 19.2527 19.4075 19.6299 19.046C20.007 18.6747 20.3939 18.318 20.7904 17.976C21.0321 17.7806 21.211 17.6829 21.3271 17.6829C21.4431 17.6829 21.6317 17.7806 21.8928 17.976C22.7052 18.6893 23.416 19.3928 24.0253 20.0866C24.151 20.2527 24.2574 20.3895 24.3444 20.497C24.4314 20.5947 24.475 20.7071 24.475 20.8341C24.475 20.9709 24.4266 21.093 24.3299 21.2005C24.2429 21.308 24.1365 21.4497 24.0108 21.6256C23.7303 21.948 23.4015 22.29 23.0243 22.6516C22.6568 23.0033 22.2797 23.3502 21.8928 23.6922C21.6511 23.8974 21.4625 24 21.3271 24C21.2207 24 21.0321 23.8974 20.7613 23.6922C20.3455 23.3502 19.9587 22.9984 19.6008 22.6369C19.243 22.2754 18.919 21.9236 18.6289 21.5816C18.4935 21.4155 18.3823 21.2836 18.2953 21.1859C18.2179 21.0882 18.1792 20.9709 18.1792 20.8341Z" fill="#484848"/>
          </g>
          <g filter="url(#filter1_di_47_99)">
          <path d="M7.83294 16.1292C7.5815 16.1292 7.40259 16.0364 7.29621 15.8508C7.15115 15.5869 7.07861 15.0935 7.07861 14.3704C7.07861 13.5203 7.23335 12.8363 7.54282 12.3185C7.86196 11.7908 8.40353 11.2729 9.16752 10.7648C9.68975 10.4131 10.1153 10.115 10.4441 9.87075C10.7826 9.62647 11.0292 9.36265 11.1839 9.07928C11.3386 8.78614 11.416 8.40995 11.416 7.9507C11.416 7.27648 11.2032 6.75861 10.7777 6.39707C10.3619 6.02576 9.77195 5.84011 9.00796 5.84011C8.36968 5.84011 7.77008 5.9427 7.20917 6.1479C6.65793 6.34333 6.2034 6.54852 5.84558 6.76349C5.71986 6.84166 5.5893 6.8612 5.45391 6.82212C5.31852 6.78303 5.22181 6.69021 5.16378 6.54364L4.04679 3.89074C3.95009 3.666 4.00328 3.49012 4.20636 3.36309C4.6609 3.07972 5.32335 2.7817 6.19373 2.46902C7.07378 2.15634 8.21978 2 9.63173 2C10.8309 2 11.9092 2.18077 12.8666 2.54231C13.8337 2.90384 14.5977 3.47546 15.1586 4.25716C15.7195 5.03886 16 6.05507 16 7.3058C16 8.21452 15.8888 8.96691 15.6664 9.56296C15.4439 10.159 15.1006 10.6915 14.6364 11.1606C14.1819 11.6198 13.6016 12.1035 12.8956 12.6116C12.0543 13.2174 11.503 13.6718 11.2419 13.9747C10.9808 14.2776 10.8503 14.5707 10.8503 14.8541C10.8503 15.0593 10.8696 15.2205 10.9083 15.3378C10.947 15.4453 10.9663 15.5674 10.9663 15.7042C10.9663 15.9876 10.7971 16.1292 10.4586 16.1292H7.83294ZM6.17922 20.8341C6.17922 20.7071 6.21791 20.5947 6.29527 20.497C6.38231 20.3895 6.49353 20.2527 6.62892 20.0866C6.91905 19.7544 7.25269 19.4075 7.62986 19.046C8.00702 18.6747 8.39385 18.318 8.79036 17.976C9.03213 17.7806 9.21104 17.6829 9.32709 17.6829C9.44314 17.6829 9.63173 17.7806 9.89284 17.976C10.7052 18.6893 11.416 19.3928 12.0253 20.0866C12.151 20.2527 12.2574 20.3895 12.3444 20.497C12.4314 20.5947 12.475 20.7071 12.475 20.8341C12.475 20.9709 12.4266 21.093 12.3299 21.2005C12.2429 21.308 12.1365 21.4497 12.0108 21.6256C11.7303 21.948 11.4015 22.29 11.0243 22.6516C10.6568 23.0033 10.2797 23.3502 9.89284 23.6922C9.65107 23.8974 9.46249 24 9.32709 24C9.22071 24 9.03213 23.8974 8.76135 23.6922C8.3455 23.3502 7.95866 22.9984 7.60084 22.6369C7.24302 22.2754 6.91905 21.9236 6.62892 21.5816C6.49353 21.4155 6.38231 21.2836 6.29527 21.1859C6.21791 21.0882 6.17922 20.9709 6.17922 20.8341Z" fill="#484848"/>
          </g>
          <g filter="url(#filter2_di_47_99)">
          <path d="M31.8329 16.1292C31.5815 16.1292 31.4026 16.0364 31.2962 15.8508C31.1511 15.5869 31.0786 15.0935 31.0786 14.3704C31.0786 13.5203 31.2333 12.8363 31.5428 12.3185C31.862 11.7908 32.4035 11.2729 33.1675 10.7648C33.6898 10.4131 34.1153 10.115 34.4441 9.87075C34.7826 9.62647 35.0292 9.36265 35.1839 9.07928C35.3386 8.78614 35.416 8.40995 35.416 7.9507C35.416 7.27648 35.2032 6.75861 34.7777 6.39707C34.3619 6.02576 33.772 5.84011 33.008 5.84011C32.3697 5.84011 31.7701 5.9427 31.2092 6.1479C30.6579 6.34333 30.2034 6.54852 29.8456 6.76349C29.7199 6.84166 29.5893 6.8612 29.4539 6.82212C29.3185 6.78303 29.2218 6.69021 29.1638 6.54364L28.0468 3.89074C27.9501 3.666 28.0033 3.49012 28.2064 3.36309C28.6609 3.07972 29.3234 2.7817 30.1937 2.46902C31.0738 2.15634 32.2198 2 33.6317 2C34.8309 2 35.9092 2.18077 36.8666 2.54231C37.8337 2.90384 38.5977 3.47546 39.1586 4.25716C39.7195 5.03886 40 6.05507 40 7.3058C40 8.21452 39.8888 8.96691 39.6664 9.56296C39.4439 10.159 39.1006 10.6915 38.6364 11.1606C38.1819 11.6198 37.6016 12.1035 36.8956 12.6116C36.0543 13.2174 35.503 13.6718 35.2419 13.9747C34.9808 14.2776 34.8503 14.5707 34.8503 14.8541C34.8503 15.0593 34.8696 15.2205 34.9083 15.3378C34.947 15.4453 34.9663 15.5674 34.9663 15.7042C34.9663 15.9876 34.7971 16.1292 34.4586 16.1292H31.8329ZM30.1792 20.8341C30.1792 20.7071 30.2179 20.5947 30.2953 20.497C30.3823 20.3895 30.4935 20.2527 30.6289 20.0866C30.919 19.7544 31.2527 19.4075 31.6299 19.046C32.007 18.6747 32.3939 18.318 32.7904 17.976C33.0321 17.7806 33.211 17.6829 33.3271 17.6829C33.4431 17.6829 33.6317 17.7806 33.8928 17.976C34.7052 18.6893 35.416 19.3928 36.0253 20.0866C36.151 20.2527 36.2574 20.3895 36.3444 20.497C36.4314 20.5947 36.475 20.7071 36.475 20.8341C36.475 20.9709 36.4266 21.093 36.3299 21.2005C36.2429 21.308 36.1365 21.4497 36.0108 21.6256C35.7303 21.948 35.4015 22.29 35.0243 22.6516C34.6568 23.0033 34.2797 23.3502 33.8928 23.6922C33.6511 23.8974 33.4625 24 33.3271 24C33.2207 24 33.0321 23.8974 32.7613 23.6922C32.3455 23.3502 31.9587 22.9984 31.6008 22.6369C31.243 22.2754 30.919 21.9236 30.6289 21.5816C30.4935 21.4155 30.3823 21.2836 30.2953 21.1859C30.2179 21.0882 30.1792 20.9709 30.1792 20.8341Z" fill="#484848"/>
          </g>
          <defs>
          <filter id="filter0_di_47_99" x="16" y="2" width="12.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_99"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_99" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_99"/>
          </filter>
          <filter id="filter1_di_47_99" x="4" y="2" width="12.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_99"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_99" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_99"/>
          </filter>
          <filter id="filter2_di_47_99" x="28" y="2" width="12.5" height="22.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_47_99"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_47_99" result="shape"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset dx="0.5" dy="0.5"/>
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 1 0"/>
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_47_99"/>
          </filter>
          </defs>
        </svg>
      );
    default: return (
      <div />
    );
  }
}

export function getFlagOffset(country: string): string {
  const index = countryFlagIndexMap[country] ?? 0;
  return `-54px -${79 + index * 19}px`; //
}

export function getIndustryOffset(industry: string): string {
  const index = industryIconIndexMap[industry] ?? 0;
  return `-79px -${1 + index * 25}px`; //
}

interface GameCellProps {
  index: number;
  cellIndex: number | null;
  onClickFirm?: (e: React.MouseEvent<HTMLDivElement>) => void;
}

export const GameCell = forwardRef<HTMLDivElement, GameCellProps>(
  function GameCell({ index, cellIndex, onClickFirm }, ref) {
    const field = fieldDefinitions.find((f) => f.index === cellIndex) ?? null;
    const players = useGameStore((state) => state.players);
    const fieldStates = useGameStore((state) => state.fieldStates);
    const fieldState = fieldStates.find(f => f.index === cellIndex);

    const ownerId = fieldState?.ownerId;
    const owner = players.find(p => p.id === ownerId);

    const playersHere = cellIndex !== null
      ? players.filter((p) => p.position === cellIndex)
      : [];

    if (!field) return <div className="bg-transparent" />;

    const highlightedCompanies = useGameStore((s) => s.highlightedCompanies);
    const isHighlighted = highlightedCompanies.includes(field.index);

    const isFirm = field.type === FieldType.Firm;

    const interaction = useCellInteractionState(field, fieldState);

    return (
      <div
        ref={ref}
        className={clsx(
          'relative w-full h-full border-1 border-gray-300 transition-colors duration-500 select-none',
          {
            'bg-yellow-300 cursor-pointer': isHighlighted,
            'bg-yellow-400 cursor-pointer': interaction.isTarget,
            'bg-red-500 cursor-pointer': interaction.isCandidate,
            'bg-[#c0c0c0] hover:bg-green-400 cursor-pointer': isFirm && !interaction.isTarget && !interaction.isCandidate,
            'bg-[#c0c0c0]': !isFirm || (!interaction.isTarget && !interaction.isCandidate && !interaction.isHighlighted),
          }
        )}
        onClick={isFirm || (interaction.isTarget) ? onClickFirm : undefined}
      >
        <div
          className="w-full h-full"
          style={{
            border: isFirm && owner ? `4px solid ${owner.color}` : undefined,
          }}
        >
          {/* Иконка в центре — если не фирма */}
          {!isFirm && (
            <div className="w-full h-full flex items-center justify-center">
              {getFielsIcon(field.type)}
              {/*<div className="icon-wrapper">
                <div className={`sprite sprite-${field.type}`} />
              </div>*/}
            </div>
          )}

          {/* Контент фирмы */}
          {isFirm && (
            <>
              {/* Флаг страны */}
              <div className="absolute top-[7px] left-[7px] w-5 h-5 bg-flag bg-no-repeat bg-contain" style={{
                backgroundPosition: getFlagOffset(field.country)
              }} />

              {/* Иконка типа компании */}
              <div className="absolute top-[4px] right-[4px] w-5 h-5 bg-ind bg-no-repeat bg-contain" style={{
                backgroundPosition: getIndustryOffset(field.industry)
              }} />

              {/* Название */}
              <div className="absolute inset-0 flex items-center justify-center text-[18px] text-center font-mono px-1">
                {field.name}
              </div>
            </>
          )}

          {/* Фишки игроков */}
          <div className="absolute bottom-1 left-1 right-1 flex gap-[2px] flex-wrap justify-center items-center">
            {playersHere.map((player) => (
              <div
                key={player.id}
                className="w-3 h-3 rounded-full"
                style={{ backgroundColor: player.color }}
                title={player.name}
              />
            ))}
          </div>
        </div>
      </div>
    );
  }
);
